---
import { type CollectionEntry, getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";

import { render } from "astro:content";
import { viewRecipeById } from "@/services/recipes";

export async function getStaticPaths() {
  const recipes = await getCollection("recipe");

  return recipes.map((recipe) => ({
    params: { slug: recipe.data.id },
    props: recipe,
  }));
}

type Props = CollectionEntry<"recipe">;

const recipe = Astro.props;

const {
  mainImage,
  title,
  description,
  id,
  cookingTime,
  portions,
  cuisine,
  categories,
  language,
  ingridients,
} = recipe.data;

const [{ Content }] = await Promise.all([render(recipe), viewRecipeById(id)]);
---

<BaseLayout
  title={title}
  description={description}
  image={mainImage}
>
  <section class="content">
    <Content />
  </section>
</BaseLayout>
